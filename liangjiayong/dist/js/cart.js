"use strict";$(function(){function e(){$.ajax({type:"post",url:"../api/getfromcart.php",async:!0,data:{what:1},success:function(a){var s=JSON.parse(a);if(console.log(s.length),0==s.length){if(0<$(".ncc-null-shopping").length)n="";else{$(".ncc-main").html("");var n='<div class="ncc-null-shopping"><i class="ico"></i>\n                    <h4>您的购物车还没有商品</h4>\n                    <p><a class="btn btn-sm btn-success m-r-10" href="http://localhost:1811/liangjiayong/src/ind.html"><i class="fa fa-reply-all"></i>马上去购物</a> <a class="btn btn-sm btn-default" href="/member/orders/list"><i class="fa fa-file-text"></i>查看自己的订单</a></p>\n                    <span style="color:#ffffff;position: absolute;">www.cnrmall.com</span></div>'}$(".ncc-head-wrap ").after(n)}else if(""!=$(".ncc-main").html())t="";else{var t='<div class="ncc-main">\n                        <div class="ncc-title ncc-wrapper">\n                            <h3>我的购物车</h3>\n                            <h5>查看购物车中所添加的商品；增加减少数量、并勾选确认想要购买的商品进入下一步操作。</h5>\n                        </div>\n                        <div class="ncc-cart-status">购物车状态：<span class="bar"><span class="sub" id="buyMaxTopPanel" data-max="50"\n                                    style="width: 4px;"></span></span><span class="sum" id="buyTopSumPanel">2/50（线上：2，门店：0）</span></div>\n                        <form action="/buy" method="POST" id="form_buy" name="form_buy">\n                            <input type="hidden" value="1" name="isCart">\n                            <input type="hidden" name="buyData" id="buyDataInput" value="">\n                            <input type="hidden" name="isExistBundling" id="isExistBundlingInput" value="0">\n                            <div class="ncc-wrapper">\n                                <div id="normalGoodsList">\n                                    <div class="ncc-mod-thead">\n                                        <ul class="columns">\n                                            <li class="col-opt"><span class="checkbox-layout">\n                                                    <label><input type="checkbox" class="checkbox" id="checkedAllBtn"\n                                                            autocomplete="off">全选</label>\n                                                </span></li>\n                                            <li class="col-goods">商品</li>\n                                            <li class="col-quantity">数量</li>\n                                            <li class="col-unitprice">单价</li>\n                                            <li class="col-rebate">优惠</li>\n                                            <li class="col-amount">金额</li>\n                                        </ul>\n                                    </div>\n\n                                    <div class="ncc-mod-tbody" id="modTbody_1">\n                                        <div class="store-bar">\n                                            <div class="fl"> <span class="checkbox-layout">\n                                                    <input type="checkbox" class="checkbox J-store-all-check" data-store-all-check="1"\n                                                        autocomplete="off" id="storeAllCheck_1">\n                                                    <label></label>\n                                                </span><a class="store-name" href="/store/1">官方店铺</a>\n                                            </div>\n                                            <div class="fr"> </div>\n                                        </div>\n\n                                    </div>\n                                    <div class="ncc-mod-tbody" id="modTbody_28">\n                                        <div class="store-bar">\n                                            <div class="fl"> <span class="checkbox-layout">\n                                                    <input type="checkbox" class="checkbox J-store-all-check" data-store-all-check="28"\n                                                        autocomplete="off" id="storeAllCheck_28">\n                                                    <label></label>\n                                                </span><a class="store-name" href="/store/28">中国农垦官方旗舰店</a>\n                                            </div>\n                                            <div class="fr"> </div>\n                                        </div>\n\n                                    </div>\n\n                                    <div id="modTfootPanelShow">\n                                        <div class="ncc-mod-tfoot " id="modTfootPanel">\n                                            <div id="disableBuyTips" class="group-wrapper group-popup hidden">\n                                                <div id="J_SelectedItemsList" class="group-content">\n                                                    <div class="group-top-title">\n                                                        <p>请分开结算以下商品</p>\n                                                        <span id="J_group_close_btn" class="group-close-btn"></span>\n                                                    </div>\n                                                    <div class="groups-list" id="disableBuyTipsGoodsList"></div>\n                                                </div><span class="arrow"></span>\n                                            </div>\n                                            <div class="actions"><span class="checkbox-layout">\n\n                                                    <label for="checkedAllBottomBtn"><input type="checkbox" class="checkbox"\n                                                            id="checkedAllBottomBtn" autocomplete="off">全选</label>\n                                                </span> <a href="javascript:;" class="delete-checked" id="mDelSkuBtn">删除</a> </div>\n                                            <div class="summary">\n                                                <dl>\n                                                    <dt>选购商品种类：</dt>\n                                                    <dd class="kinds-total"><span class="value" id="kindsTotal">0</span>种</dd>\n                                                    <dt>选购数量总计：</dt>\n                                                    <dd class="quantity-total"><span class="value" id="quantityTotal">0</span>件</dd>\n                                                    <dt>商品金额总计：</dt>\n                                                    <dd class="amount-total"><strong class="value" id="amountTotal">\n                                                            <span class="yuan">￥</span><span class="integer">0</span><span\n                                                                class="pointer">.</span><span class="decimal">00</span>\n                                                        </strong></dd>\n                                                </dl>\n                                            </div>\n                                            <div class="form">\n                                                <button id="cartSubmit" class="checkout checkout-disabled">结算</button>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </form>\n                    </div>';$(".ncc-head-wrap ").after(t)}!function(a){for(var s=JSON.parse(a),n=0;n<s.length;n++)if("官方店铺"==s[n].shop){var t=s[n],e=t.counts*t.goods_price,i='<div class="goods-zone"  data-id="'+t.gid+'">\n                <div class="mask-layer"><span class="top"></span><span class="right"></span><span\n                        class="bottom"></span><span class="left"></span></div>\n                <div class="fl m-r-5"><span class="checkbox-layout fcheckbox">\n                        <input type="checkbox" class="checkbox J-spu-checkbox" \n                            data-spu-checkbox="'+t.gid+'" data-goods-modal="1" data-spu-store-id="1"\n                            autocomplete="off" data-is-chain="0" data-is-virtual="0" data-is-foreign="0"\n                            data-img="../images/cart1.jpg" data-goods-name="汾酒100年汾藏1989珍藏组 货号123478"\n                            data-real-common-id="0" data-goods-type="0">\n                        <label></label>\n                    </span> </div>\n                <div class="goods-img">\n                    <div class="img-vertical"><a target="_blank" href="/goods/5812"><img\n                                src="../'+t.list_pic+'" alt=""\n                                style="max-width:100%; max-height:100%"></a></div>\n                </div>\n                <div class="goods-main">\n                    <div class="spu-name"><span class="tag tag1"></span><a href="/goods/5812"\n                            target="_blank">'+t.goods_name1+'</a>\n                        <div class="attributes"> </div>\n                    </div>\n\n                    <div class="panel-remove"> <a\n                            class="icon-delete" href="javascript:;" title="删除该商品" data-delete="'+t.gid+'"><i class="fa fa-trash-o"\n                                aria-hidden="true"></i></a></div>\n                    <div class="panel-modify"><a href="javascript:;" data-mod-id="5812"><i\n                                class="fa fa-pencil" aria-hidden="true"></i><span\n                                data-spu-mod="">修改</span></a></div>\n                    <table class="spu-singles">\n                        <tbody>\n                            <tr class="goods-sku" id="goodsSkuPanel_9451" data-goods-spu="5812"\n                                data-sku-id="9451" data-cart-id="722" data-goods-modal="1"\n                                data-goods-type="normal" data-goods-web-usable="0" data-web-price0="698.00"\n                                data-web-price1="0.00" data-web-price2="0.00" data-goods-price0="698"\n                                data-goods-price1="0" data-goods-price2="0" data-is-spec="0"\n                                data-goods-storage="13" data-buy-limit="10" data-unit-name="组"\n                                data-chain-id="0" data-is-chain="0">\n                                <td>&nbsp;</td>\n                                <td class="sku-opt"> </td>\n                                <td class="sku-primary"></td>\n                                <td class="sku-quantity">\n                                    <div class="sku-quantity-block clearfix"><a href="javascript:;"\n                                            class="minus " title="减少" data-id="'+t.gid+'"><i class="fa fa-minus"\n                                                aria-hidden="true">-</i></a>\n                                        <input type="text" class="input-text" value="'+t.counts+'"\n                                            id="buynum_'+t.gid+'" autocomplete="off">\n                                        <a href="javascript:;" class="plus " title="增加" data-id="'+t.gid+'" data-limit="'+t.buy_limit+'"><i\n                                                class="fa fa-plus" aria-hidden="true">+</i></a> <span\n                                            class="text-warning"></span></div>\n                                </td>\n                                <td class="sku-delete"><a href="javascript:;" title="删除"\n                                        data-goods-spec-del="722"><i class="fa fa-trash-o"\n                                            aria-hidden="true"></i></a></td>\n                                <td class="sku-unitprice">\n                                    <span class="number number-thin" id="singleprice_'+t.gid+'">\n                                        <span class="yuan">￥</span><span class="integer">'+t.goods_price+'</span>\n                                    </span>\n                                </td>\n                                <td class="sku-rebate"> </td>\n                                <td class="sku-amount">\n                                    <div class="sku-amount-block"><em id="totalprice_'+t.gid+'"\n                                            class="number number-14">\n                                            <span class="yuan">￥</span><span\n                                                class="integer">'+e+'</span><span\n                                                class="pointer">.</span><span class="decimal">00</span>\n                                        </em></div>\n                                </td>\n                            </tr>\n                        </tbody>\n\n                    </table>\n                </div>\n            </div>';$("#modTbody_1").append(i)}else if("中国农垦官方旗舰店"==s[n].shop){var c=s[n],d=c.counts*c.goods_price,o='<div class="goods-zone" data-id="'+c.gid+'" >\n                <div class="mask-layer"><span class="top"></span><span class="right"></span><span\n                        class="bottom"></span><span class="left"></span></div>\n                <div class="fl m-r-5"><span class="checkbox-layout scheckbox">\n                        <input type="checkbox" class="checkbox J-spu-checkbox" \n                            data-spu-checkbox="12366" data-goods-modal="1" data-spu-store-id="28"\n                            autocomplete="off" data-is-chain="0" data-is-virtual="0" data-is-foreign="0"\n                            data-img="https://pic5.cnrmall.com/image/80/76/8076686a49f04adba415a06f6def9223.jpg@160w_160h"\n                            data-goods-name="方家铺子 黑枸杞  青海黑枸杞 50g*5瓶" data-real-common-id="0"\n                            data-goods-type="0">\n                        <label></label>\n                    </span> </div>\n                <div class="goods-img">\n                    <div class="img-vertical"><a target="_blank" href="/goods/12366"><img\n                                src="../'+c.list_pic+'"\n                                alt="" style="max-width:100%; max-height:100%"></a></div>\n                </div>\n                <div class="goods-main">\n                    <div class="spu-name"><span class="tag tag1"></span><a href="/goods/12366"\n                            target="_blank">'+c.goods_name1+'</a>\n                        <div class="attributes"> </div>\n                    </div>\n\n                    <div class="panel-remove"> <a\n                            class="icon-delete" href="javascript:;" title="删除该商品" '+c.gid+'><i class="fa fa-trash-o"\n                                aria-hidden="true"></i></a></div>\n                    <div class="panel-modify"><a href="javascript:;" data-mod-id="12366"><i\n                                class="fa fa-pencil" aria-hidden="true"></i><span\n                                data-spu-mod="">修改</span></a></div>\n                    <table class="spu-singles">\n                        <tbody>\n                            <tr class="goods-sku" id="goodsSkuPanel_12821" data-goods-spu="12366"\n                                data-sku-id="12821" data-cart-id="726" data-goods-modal="1"\n                                data-goods-type="normal" data-goods-web-usable="0" data-web-price0="139.00"\n                                data-web-price1="0.00" data-web-price2="0.00" data-goods-price0="139"\n                                data-goods-price1="0" data-goods-price2="0" data-is-spec="1"\n                                data-goods-storage="200" data-buy-limit="0" data-unit-name=""\n                                data-chain-id="0" data-is-chain="0">\n                                <td>&nbsp;</td>\n                                <td class="sku-opt"> <span class="checkbox-layout">\n                                        <input class="J-sku-checkbox" autocomplete="off" type="checkbox"\n                                            data-sku-checkbox="12821" data-sku-amount="0" data-sku-num="0"\n                                            data-target="spuCheckBox_12366" data-is-chain="0"\n                                            data-is-virtual="0" data-is-foreign="0" data-goods-type="0">\n                                        <label></label>\n                                    </span> </td>\n                                <td class="sku-primary">颜色：共同 </td>\n                                <td class="sku-quantity">\n                                    <div class="sku-quantity-block clearfix"><a href="javascript:;"\n                                            class="minus " title="减少" data-id="'+c.gid+'"><i class="fa fa-minus"\n                                                aria-hidden="true">-</i></a>\n                                        <input type="text" class="input-text" value="'+c.counts+'"\n                                            id="buynum_'+c.gid+'" autocomplete="off">\n                                        <a href="javascript:;" class="plus " title="增加" data-id="'+c.gid+'" data-limit="'+c.buy_limit+'"><i\n                                                class="fa fa-plus" aria-hidden="true">+</i></a> <span\n                                            class="text-warning"></span></div>\n                                </td>\n                                <td class="sku-delete"><a href="javascript:;" title="删除"\n                                        data-goods-spec-del="726"><i class="fa fa-trash-o"\n                                            aria-hidden="true"></i></a></td>\n                                <td class="sku-unitprice">\n                                    <span class="number number-thin" id="singleprice_'+c.gid+'">\n                                        <span class="yuan">￥</span><span class="integer">'+c.goods_price+'</span>\n                                    </span>\n                                </td>\n                                <td class="sku-rebate"> </td>\n                                <td class="sku-amount">\n                                    <div class="sku-amount-block"><em id="totalprice_'+c.gid+'"\n                                            class="number number-14">\n                                            <span class="yuan">￥</span><span class="integer">'+d+'</span><span\n                                                class="pointer">.</span><span class="decimal">00</span>\n                                        </em></div>\n                                </td>\n                            </tr>\n                        </tbody>\n\n                    </table>\n                </div>\n            </div>';$("#modTbody_28").append(o)}}(a),function(){function d(){for(var a=[],s=0;s<$(".goods-zone .checkbox").length;s++)$($(".goods-zone .checkbox")[s]).prop("checked")&&a.push($($(".goods-zone .checkbox")[s]).parents(".goods-zone"));for(var n=0,t=0,e=0;e<a.length;e++)t+=1*a[e].find(".input-text").val(),n+=1*a[e].find(".number-14 .integer").html();var i=a.length;$("#kindsTotal").html(i),$("#quantityTotal").html(t),$("#amountTotal .integer").html(n)}$(".plus ").on("click",function(){var c=$(this);$.ajax({type:"post",url:"../api/changecount.php",async:!0,data:{gid:$(this).attr("data-id"),dowhat:1},success:function(){var a="#buynum_"+c.attr("data-id"),s=""+c.attr("data-limit"),n=1*$(a).val()+1;1*s<=n&&(n=1*s),$(a).attr("value",n);var t="#totalprice_"+c.attr("data-id")+" span.integer",e="#singleprice_"+c.attr("data-id")+" span.integer",i=n*(1*$(e).html());$(t).html(i),d()}})}),$(".minus ").on("click",function(){var i=$(this);$.ajax({type:"post",url:"../api/changecount.php",async:!0,data:{gid:$(this).attr("data-id"),dowhat:0},success:function(){var a="#buynum_"+i.attr("data-id"),s=1*$(a).val()-1;s<1&&(s=1),$(a).attr("value",s);var n="#totalprice_"+i.attr("data-id")+" span.integer",t="#singleprice_"+i.attr("data-id")+" span.integer",e=s*(1*$(t).html());$(n).html(e),d()}})}),$(".icon-delete").on("click",function(){$(this).parent().parent().parent().remove(),$(this).attr("data-delete");var a=$(this);$.ajax({type:"post",url:"../api/deletecart.php",async:!0,data:{gid:a.attr("data-delete")},success:function(){d()}})}),$("#mDelSkuBtn").on("click",function(){var a=confirm("确定删除？");if(a){var s=function(){for(var a=[],s=0;s<$(".goods-zone .checkbox").length;s++)$($(".goods-zone .checkbox")[s]).prop("checked")&&a.push($($(".goods-zone .checkbox")[s]).parents(".goods-zone").attr("data-id"));return a}();console.log(s);for(var n=0;n<s.length;n++)$.ajax({type:"post",url:"../api/deletecart.php",async:!0,data:{gid:s[n]},success:function(){e();for(var a=$(".goods-zone .checkbox").length-1;0<=a;a--)$($(".goods-zone .checkbox")[a]).prop("checked")&&$($(".goods-zone .checkbox")[a]).parents(".goods-zone").remove();d(),location.reload()}})}}),$("#storeAllCheck_1").on("click",function(){$(this).prop("checked")?$(".fcheckbox input").prop("checked","checked"):$(".fcheckbox input").removeAttr("checked")}),$("#storeAllCheck_28").on("click",function(){$(this).prop("checked")?$(".scheckbox input").prop("checked","checked"):$(".scheckbox input").removeAttr("checked")}),$("#checkedAllBtn").on("click",function(){$(this).prop("checked")?$(".checkbox").prop("checked","checked"):$(".checkbox").removeAttr("checked")}),$("#checkedAllBottomBtn").on("click",function(){$(this).prop("checked")?$(".checkbox").prop("checked","checked"):$(".checkbox").removeAttr("checked")}),$(".checkbox").on("click",d),$(".login").on("mouseover",function(){$(this).addClass("hover")}),$(".login").on("mouseout",function(){$(this).removeClass("hover")});var a=$("#modTfootPanelShow").offset().top;$(window).on("scroll",function(){$(window).scrollTop()+$(window).height()<$("#modTfootPanelShow").height()+a?$("#modTfootPanel").addClass("tfoot-fix-bottom"):$("#modTfootPanel").removeClass("tfoot-fix-bottom")})}()}})}e()});